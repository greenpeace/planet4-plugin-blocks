jQuery(document).ready(function(){$(".notice.is-dismissible").animate({"margin-left":"+=20",opacity:"+=0.9"},800),setTimeout(function(){$(".notice.is-dismissible").fadeOut(2e3,function(){$(this).remove()})},3800)}),"undefined"!==sui.views&&(sui.views.editAttributeSelect2Field.prototype.preselect=function(e){var t=String(this.getValue());if(t.length){var o={include:t,shortcode:this.shortcode.get("shortcode_tag"),attr:this.model.get("attr")};return"shortcake_newcovers"===this.shortcode.get("shortcode_tag")&&"posts"===this.model.get("attr")&&(this.ajaxData.action="planet4_blocks_post_field"),$.get(ajaxurl,$.extend(o,this.ajaxData),function(t){_.each(t.data.items,function(t){$("<option>").attr("value",t.id).text(t.text).prop("selected","selected").appendTo(e)})})}return null},sui.views.editAttributeSelect2Field.prototype.render=function(){var e=this,t={multiple:!1};for(var o in t)this.model.get(o)||this.model.set(o,t[o]);var s=this.model.toJSON();s.id="shortcode-ui-"+this.model.get("attr")+"-"+this.model.cid,this.$el.html(this.template(s));var i=this.$el.find(this.selector);void 0===this.shortcode.get("ajax_requests")&&this.shortcode.set("ajax_requests",[]);var a=this.preselect(i);if(null!==a){var c=this.shortcode.get("ajax_requests");Array.isArray(c)&&(c.push(a),this.shortcode.set("ajax_requests",c))}var d=this.model.get("meta").select2_options,l={multiple:this.model.get("multiple"),dropdownParent:this.$el,allowClear:!0,ajax:{url:ajaxurl,dataType:"json",delay:250,data:function(t){return"shortcake_newcovers"===e.shortcode.get("shortcode_tag")&&"posts"===e.model.get("attr")?(e.ajaxData.action="planet4_blocks_post_field",$.extend({type:function(){return $("input[name=cover_type]:checked").val()},s:t.term,page:t.page,shortcode:e.shortcode.get("shortcode_tag"),attr:e.model.get("attr"),action:"wp_ajax_planet4_blocks_post_field"},e.ajaxData)):$.extend({s:t.term,page:t.page,shortcode:e.shortcode.get("shortcode_tag"),attr:e.model.get("attr")},e.ajaxData)},processResults:function(e,t){var o=e.data;return t.page=t.page||1,e.success&&void 0!==e.data?{results:o.items,pagination:{more:t.page*o.items_per_page<o.found_items}}:{results:[]}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:0,templateResult:this.templateResult,templateSelection:this.templateSelection},r=Object.assign({},l,d),n=this;return _.defer(function(){i[shortcodeUIData.select2_handle](r);n.model.get("multiple")&&n.sortable(i)},n,i),this}),jQuery(function(e){"use strict";if(void 0!==wp.shortcake){shortcodeUIFieldData.p4_select={encode:!1,template:"shortcode-ui-field-p4-select",view:"editAttributeHeading"},shortcodeUIFieldData.p4_checkbox={encode:!1,template:"shortcode-ui-field-p4-checkbox",view:"editAttributeHeading"},shortcodeUIFieldData.p4_radio={encode:!1,template:"shortcode-ui-field-p4-radio",view:"editAttributeHeading"};var t=function(){e(".shortcode-ui-attribute-heading2").parent().before("<p></p>"),e(".shortcode-ui-attribute-heading3").parent().before("<p></p>")};wp.shortcake.hooks.addAction("shortcode-ui.render_edit",t),wp.shortcake.hooks.addAction("shortcode-ui.render_new",t)}});var p4_blocks={hooks_defined:!1,initialize_view_fields:function(e){switch(e){case"articles":p4_blocks.articles.initialize_view_fields();break;case"newcovers":p4_blocks.newcovers.initialize_view_fields()}},find_view:function(e,t){return _.find(e,function(e){return t===e.model.get("attr")})},newcovers:{type_of_cover_change_hook:function(){var e=$("input[name=cover_type]:checked").val();"undefined"!==e&&("1"===e?($("select[id^='shortcode-ui-post_types']").prop("disabled","disabled"),$("select[id^='shortcode-ui-posts']").prop("disabled",!1),$("select[id^='shortcode-ui-posts']").val(null).trigger("change"),$("select[id^='shortcode-ui-tags']").val(null).trigger("change")):"2"===e?($("select[id^='shortcode-ui-post_types']").prop("disabled","disabled"),$("select[id^='shortcode-ui-posts']").prop("disabled","disabled"),$("select[id^='shortcode-ui-posts']").val(null).trigger("change"),$("select[id^='shortcode-ui-tags']").val(null).trigger("change")):"3"===e&&($("select[id^='shortcode-ui-post_types']").prop("disabled",!1),$("select[id^='shortcode-ui-posts']").prop("disabled",!1),$("select[id^='shortcode-ui-posts']").val(null).trigger("change"),$("select[id^='shortcode-ui-tags']").val(null).trigger("change")))},initialize_view_fields:function(){var e=$("input[name=cover_type]:checked").val(),t=$("select[id^='shortcode-ui-posts']").val(),o=$("select[id^='shortcode-ui-tags']").val(),s=$("select[id^='shortcode-ui-post_types']").val();"undefined"!==e&&("1"===e?($("select[id^='shortcode-ui-post_types']").prop("disabled","disabled"),$("select[id^='shortcode-ui-post_types']").val(null).trigger("change"),null===o&&null===s||($("select[id^='shortcode-ui-posts']").prop("disabled","disabled"),$("select[id^='shortcode-ui-posts']").val(null).trigger("change")),null!==t&&($("select[id^='shortcode-ui-tags']").prop("disabled","disabled"),$("select[id^='shortcode-ui-tags']").val(null).trigger("change"))):"2"===e?($("select[id^='shortcode-ui-post_types']").prop("disabled","disabled"),$("select[id^='shortcode-ui-post_types']").val(null).trigger("change"),$("select[id^='shortcode-ui-posts']").prop("disabled","disabled"),$("select[id^='shortcode-ui-posts']").val(null).trigger("change")):"3"===e&&(null===o&&null===s||($("select[id^='shortcode-ui-posts']").prop("disabled","disabled"),$("select[id^='shortcode-ui-posts']").val(null).trigger("change")),null!==t&&($("select[id^='shortcode-ui-tags']").prop("disabled","disabled"),$("select[id^='shortcode-ui-tags']").val(null).trigger("change"),$("select[id^='shortcode-ui-post_types']").prop("disabled","disabled"),$("select[id^='shortcode-ui-post_types']").val(null).trigger("change"))))},post_types_change_hook:function(){var e=$("input[name=cover_type]:checked").val(),t=$("select[id^='shortcode-ui-tags']").val(),o=$("select[id^='shortcode-ui-post_types']").val(),s=$("select[id^='shortcode-ui-posts']").val();"undefined"!==e&&"3"===e&&(null!==o?($("select[id^='shortcode-ui-tags']").prop("disabled",!1),$("select[id^='shortcode-ui-post_types']").prop("disabled",!1),$("select[id^='shortcode-ui-posts']").val(null).trigger("change"),$("select[id^='shortcode-ui-posts']").prop("disabled","disabled")):null===t&&null===s&&null===o&&($("select[id^='shortcode-ui-tags']").prop("disabled",!1),$("select[id^='shortcode-ui-post_types']").prop("disabled",!1),$("select[id^='shortcode-ui-posts']").prop("disabled",!1)))},posts_select_change_hook:function(){var e=$("input[name=cover_type]:checked").val(),t=$("select[id^='shortcode-ui-posts']").val();"undefined"!==e&&(null!==t?"1"===e?($("select[id^='shortcode-ui-tags']").val(null).trigger("change"),$("select[id^='shortcode-ui-tags']").prop("disabled","disabled")):"3"===e&&($("select[id^='shortcode-ui-tags']").val(null).trigger("change"),$("select[id^='shortcode-ui-tags']").prop("disabled","disabled"),$("select[id^='shortcode-ui-post_types']").val(null).trigger("change"),$("select[id^='shortcode-ui-post_types']").prop("disabled","disabled")):"1"===e?$("select[id^='shortcode-ui-tags']").prop("disabled",!1):"3"===e&&($("select[id^='shortcode-ui-tags']").prop("disabled",!1),$("select[id^='shortcode-ui-post_types']").prop("disabled",!1)))},tags_change_hook:function(){var e=$("input[name=cover_type]:checked").val(),t=$("select[id^='shortcode-ui-posts']").val(),o=$("select[id^='shortcode-ui-tags']").val(),s=$("select[id^='shortcode-ui-post_types']").val();"undefined"!==e&&("1"===e?null!==o||null!==s?($("select[id^='shortcode-ui-posts']").prop("disabled","disabled"),$("select[id^='shortcode-ui-posts']").val(null).trigger("change"),$("select[id^='shortcode-ui-post_types']").prop("disabled","disabled")):null===o&&null===t&&($("select[id^='shortcode-ui-tags']").prop("disabled",!1),$("select[id^='shortcode-ui-posts']").prop("disabled",!1)):"2"===e?($("select[id^='shortcode-ui-posts']").prop("disabled","disabled"),$("select[id^='shortcode-ui-posts']").val(null).trigger("change"),$("select[id^='shortcode-ui-tags']").prop("disabled",!1),$("select[id^='shortcode-ui-post_types']").val(null).trigger("change"),$("select[id^='shortcode-ui-post_types']").prop("disabled","disabled")):"3"===e&&(null!==o?($("select[id^='shortcode-ui-tags']").prop("disabled",!1),$("select[id^='shortcode-ui-post_types']").prop("disabled",!1),$("select[id^='shortcode-ui-posts']").val(null).trigger("change"),$("select[id^='shortcode-ui-posts']").prop("disabled","disabled")):null===o&&null===t&&null===s&&$("select[id^='shortcode-ui-posts']").prop("disabled",!1)))}},articles:{page_types_change_hook:function(){var e=$("select[id^='shortcode-ui-post_types']").val(),t=$("select[id^='shortcode-ui-tags']").val();null===e&&null===t?$("select[id^='shortcode-ui-posts']").prop("disabled",!1):($("select[id^='shortcode-ui-posts']").val(null).trigger("change.select2"),$("select[id^='shortcode-ui-posts']").prop("disabled","disabled"))},posts_select_change_hook:function(){null===$("select[id^='shortcode-ui-posts']").val()?($("select[id^='shortcode-ui-tags']").prop("disabled",!1),$("select[id^='shortcode-ui-post_types']").prop("disabled",!1),$("input[name^='ignore_categories']").prop("disabled",!1)):($("select[id^='shortcode-ui-post_types']").val(null).trigger("change.select2"),$("select[id^='shortcode-ui-post_types']").prop("disabled","disabled"),$("select[id^='shortcode-ui-tags']").val(null).trigger("change.select2"),$("select[id^='shortcode-ui-tags']").prop("disabled","disabled"),$("input[name^='ignore_categories']").prop("disabled","disabled"))},read_more_change_hook:function(e,t,o){var s=p4_blocks.find_view(t,"read_more_link");if("undefined"!==s&&void 0!==e.value){var i="";"undefined"!==(i=/%[0-9a-f]/i.test(e.value)?e.value:encodeURI(e.value))&&(s.model.set("value",i),$("*[id^='shortcode-ui-read_more_link-']").val(i))}},initialize_view_fields:function(){var e=$("select[id^='shortcode-ui-posts']").val(),t=$("select[id^='shortcode-ui-tags']").val(),o=$("select[id^='shortcode-ui-post_types']").val();null!==e?($("select[id^='shortcode-ui-post_types']").prop("disabled","disabled"),$("select[id^='shortcode-ui-tags']").prop("disabled","disabled")):null===t&&null===o||$("select[id^='shortcode-ui-posts']").prop("disabled","disabled")}},social_media:{initialize_fields:function(){p4_blocks.social_media.set_default_embed_type(),p4_blocks.social_media.toggle_facebook_page_options()},embed_type_change_hook:function(){p4_blocks.social_media.toggle_facebook_page_options()},set_default_embed_type:function(){$("input[name=embed_type]:checked").val()||$("input[name=embed_type][value=oembed]").prop("checked",!0)},toggle_facebook_page_options:function(){var e=$(".shortcode-ui-attribute-facebook_page_tab");"facebook_page"===$("input[name=embed_type]:checked").val()?e.show():e.hide()}},columns:{render_new:function(e){$(".shortcode-ui-edit-shortcake_columns").append('<div data-row="0"><button class="button button-small shortcake-columns-add-column">Add Column</button><button class="button button-small shortcake-columns-remove-column" disabled="disabled">Remove Column</button></div>'),this.hide_all_columns(),this.add_click_event_handlers()},render_edit:function(e){$(".shortcode-ui-edit-shortcake_columns").append('<div data-row="0"><button class="button button-small shortcake-columns-add-column" data-row="1 data-action="add">Add Column</button><button class="button button-small shortcake-columns-remove-column">Remove Column</button></div>');var t=0;[1,2,3,4].forEach(function(e){""!==$(".field-block").filter($("div[class$='_"+e+"']")).children().filter($("input, textarea")).map(function(e,t){return $(t).val()}).get().join("")&&(t=e)}),$(".shortcake-columns-add-column").parent().data("row",t);for(var o=t+1;o<=4;o++)$(".field-block").filter($("div[class$='_"+o+"']")).hide();4===t&&$(".shortcake-columns-add-column").attr("disabled","disabled"),this.toggle_images(),this.add_click_event_handlers()},add_click_event_handlers:function(){var e=this;$(".shortcake-columns-add-column").on("click",function(t){t.preventDefault();var o=$(t.currentTarget),s=o.parent().data("row");s<5&&(e.show_column(++s),o.parent().data("row",s),$(".shortcake-columns-remove-column").removeAttr("disabled"),4===s&&o.attr("disabled","disabled"))}),$(".shortcake-columns-remove-column").on("click",function(t){t.preventDefault();var o=$(t.currentTarget),s=o.parent().data("row");s>=0&&(e.hide_column(s--),o.parent().data("row",s),$(".shortcake-columns-add-column").removeAttr("disabled"),0===s&&o.attr("disabled","disabled"))}),$("input[name=columns_block_style]").off("click").on("click",function(){p4_blocks.columns.toggle_images()})},hide_column:function(e){var t=$(".field-block").filter($("div[class$='_"+e+"']"));t.children().filter($("input, textarea")).each(function(e,t){$(t).val("").trigger("input")}),t.find($(".attachment-previews .remove")).each(function(e,t){$(t).click()}),t.hide(300)},hide_all_columns:function(){[1,2,3,4].forEach(function(e){$(".field-block").filter($("div[class$='_"+e+"']")).hide()})},show_column:function(e){$(".field-block").filter($("div[class$='_"+e+"']")).show(300,function(){p4_blocks.columns.toggle_images(),$(".media-frame-content").animate({scrollTop:$(".shortcode-ui-content").prop("scrollHeight")},300)})},toggle_images:function(){[1,2,3,4].forEach(function(e){var t=$(".field-block").filter($("div[class$='title_"+e+"']")).is(":visible"),o="no_image"!=$("input[name=columns_block_style]:checked").val();$(".shortcode-ui-attribute-attachment_"+e).toggle(t&&o)})}},carousel_header:{render_edit:function(){p4_blocks.carousel_header.toggle_subheaders(),p4_blocks.carousel_header.set_maxlength(),$("input[name=block_style]").off("click").on("click",function(){p4_blocks.carousel_header.toggle_subheaders(),p4_blocks.carousel_header.set_maxlength()})},toggle_subheaders:function(){var e=$("input[name=block_style]:checked").val();$("input[data-subheader=true]").closest(".field-block").toggle("full-width-classic"!=e)},add_maxlength_with_counter:function(e,t){($(e).attr("maxlength",t),$(e).next("div").length)||$('<div class="max-length-counter">0/'+t+"</div>").insertAfter(e);$(e).off("input").on("input",function(){var o=$(e).val().length;$(e).next("div.max-length-counter").html(o+"/"+t)})},set_maxlength:function(){var e=this;"full-width-classic"==$("input[name=block_style]:checked").val()?($("input[name^='header_']").each(function(){e.add_maxlength_with_counter(this,32)}),$("textarea[name^='description_']").each(function(){e.add_maxlength_with_counter(this,200)}),$("input[name^='link_text_']").each(function(){e.add_maxlength_with_counter(this,24)})):($("input[name^='header_']").attr("maxlength",40),$("textarea[name^='description_']").removeAttr("maxlength"),$("input[name^='link_text_']").removeAttr("maxlength"),$("div.maxLengthCounter").remove())}}};if(void 0!==wp.shortcake){function attach_hooks(){p4_blocks.hooks_defined||(p4_blocks.hooks_defined=!0,wp.shortcake.hooks.addAction("shortcake_newcovers.cover_type",p4_blocks.newcovers.type_of_cover_change_hook),wp.shortcake.hooks.addAction("shortcake_newcovers.tags",p4_blocks.newcovers.tags_change_hook),wp.shortcake.hooks.addAction("shortcake_newcovers.post_types",p4_blocks.newcovers.post_types_change_hook),wp.shortcake.hooks.addAction("shortcake_newcovers.posts",p4_blocks.newcovers.posts_select_change_hook),wp.shortcake.hooks.addAction("shortcake_articles.posts",p4_blocks.articles.posts_select_change_hook),wp.shortcake.hooks.addAction("shortcake_articles.post_types",p4_blocks.articles.page_types_change_hook),wp.shortcake.hooks.addAction("shortcake_articles.tags",p4_blocks.articles.page_types_change_hook),wp.shortcake.hooks.addAction("shortcake_articles.read_more_link",p4_blocks.articles.read_more_change_hook),wp.shortcake.hooks.addAction("shortcake_social_media.embed_type",p4_blocks.social_media.embed_type_change_hook)),p4_blocks.social_media.initialize_fields()}wp.shortcake.hooks.addAction("shortcode-ui.render_new",function(e){attach_hooks();var t=e.get("shortcode_tag");"shortcake_columns"===t&&p4_blocks.columns.render_new(e),"shortcake_carousel_header"===t&&p4_blocks.carousel_header.render_edit()}),wp.shortcake.hooks.addAction("shortcode-ui.render_edit",function(e){attach_hooks();var t=e.get("shortcode_tag"),o=t.replace("shortcake_","");if(["shortcake_articles","shortcake_newcovers"].includes(t)){var s=e.get("ajax_requests");if(null!==s){var i=$(".shortcode-ui-edit-"+t);i.addClass("not-clickable"),i.prev().prepend('<span class="spinner is-active" id="bl_loader"></span><span id="bl_loading_span">Populating block\'s fields..</span>'),i.animate({opacity:.5}),Promise.all(s).then(function(t){i.animate({opacity:1}),i.removeClass("not-clickable"),$("#bl_loader").removeClass("is-active"),$("#bl_loading_span").remove(),e.unset("ajax_requests"),p4_blocks.initialize_view_fields(o)})}}"shortcake_columns"===t&&p4_blocks.columns.render_edit(e),"shortcake_carousel_header"===t&&p4_blocks.carousel_header.render_edit()})}function setNoTrackCookie(){$("#necessary_cookies").is(":checked")||$("#all_cookies").is(":checked")?createCookie("no_track","true",-1):createCookie("no_track","true",7300)}jQuery(document).ready(function(){var e=readCookie("greenpeace");"1"===e?$("#necessary_cookies").prop("checked",!0):"2"===e&&($("#necessary_cookies").prop("checked",!0),$("#all_cookies").prop("checked",!0)),$("#necessary_cookies").on("change",function(){$("#necessary_cookies").is(":checked")?(createCookie("greenpeace","1",365),$(".cookie-notice").slideUp("slow")):($("#all_cookies").prop("checked",!1),createCookie("greenpeace","0",-1),$(".cookie-notice").show()),setNoTrackCookie()}),$("#all_cookies").on("change",function(){$("#all_cookies").is(":checked")?($("#necessary_cookies").prop("checked",!0),createCookie("greenpeace","2",365),$(".cookie-notice").slideUp("slow")):$("#necessary_cookies").is(":checked")?createCookie("greenpeace","1",365):(createCookie("greenpeace","0",-1),$(".cookie-notice").show()),setNoTrackCookie()})}),$(document).ready(function(){"use strict";"undefined"!==submenu&&Array.isArray(submenu)||(submenu=[]);for(var e=0;e<submenu.length;e++){var t=submenu[e];if("undefined"!==t.id&&"undefined"!==t.type&&"undefined"!==t.link){var o=t.type;if(t.link)for(var s=$("body "+o),i=0;i<s.length;i++){var a=$(s[i]);a.text()===t.text&&a.prepend('<a id="'+t.id+'"></a>')}if("undefined"!==t.children&&Array.isArray(t.children))for(var c=0;c<t.children.length;c++)for(var d=t.children[c],l=d.type,r=$("body "+l),n=0;n<r.length;n++){var u=$(r[n]);u.text()===d.text&&u.prepend('<a id="'+d.id+'"></a>')}}}$(".submenu-link").click(function(e){e.preventDefault();var t=$.attr(this,"href");return $("html, body").animate({scrollTop:$(t).offset().top-100},2e3,function(){var e=$(window).scrollTop();window.location.hash=t,$(window).scrollTop(e)}),!1})});var editAttributeHeading=sui.views.editAttributeField.extend({tagName:"span",className:"block-attribute-wrapper",events:{"input  input":"inputChanged","input  textarea":"inputChanged","change select":"inputChanged",'change input[type="radio"]':"inputChanged",'change input[type="checkbox"]':"inputChanged"},inputChanged:function(e){var t;if(this.model.get("attr")&&(t=this.$el.find('[name="'+this.model.get("attr")+'"]')),"radio"===this.model.attributes.type||"p4_radio"===this.model.attributes.type)this.setValue(t.filter(":checked").first().val());else if("checkbox"===this.model.attributes.type||"p4_checkbox"===this.model.attributes.type)this.setValue(t.is(":checked"));else if("range"===this.model.attributes.type){var o="#"+e.target.id+"_indicator",s=e.target.value;document.querySelector(o).value=s,this.setValue(t.val())}else this.setValue(t.val());this.triggerCallbacks()},setValue:function(e){this.model.set("value",e)},triggerCallbacks:function(){var e=[this.shortcode.attributes.shortcode_tag,this.model.get("attr")].join("."),t=this.model.changed,o=_.flatten(_.values(this.views.parent.views._views)),s=this.shortcode;wp.shortcake.hooks.doAction(e,t,o,s)}});sui.views.editAttributeHeading=editAttributeHeading;
//# sourceMappingURL=admin/main.js.map
